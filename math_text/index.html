<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://example.com/math_text/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Background - BridgePRS</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link href="../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Background";
        var mkdocs_page_input_path = "math_text.md";
        var mkdocs_page_url = "/math_text/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]--> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-113286405-1', 'auto');
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> BridgePRS
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Quick Start Tutorial</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../quikstart_prep/">Before Running</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quikstart_demo/">Toy-data Demo</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../detail_background/">Background</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detail_requirements/">Requirements</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detail_input/">Input Data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detail_commands/">Subprograms</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detail_output/">Output Data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detail_args/">All Arguments</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detail_shell/">Using Bash</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Misc</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../misc_faq/">Frequently Asked Questions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../misc_log/">Update Log</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">BridgePRS</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Background</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="background">Background</h1>
<p>You will need to have basic understanding of Genome Wide Association Studies (GWAS) in order to be able to 
use BridgePRS.  If you are unfamiliar with GWAS, you can consider reading <a href="https://www.ncbi.nlm.nih.gov/pubmed/29484742">this paper</a>.</p>
<p>For additive model (add)</p>
<div class="arithmatex">\[
G = G
\]</div>
<p>For dominant model (with respect to the effective allele of the base file)</p>
<div class="arithmatex">\[
    G =
  \begin{cases}
    0 &amp; \text{if $G$ = 0} \\
    1 &amp; \text{otherwise}
  \end{cases}
\]</div>
<p>For recessive model (with respect to the effective allele of the base file)</p>
<div class="arithmatex">\[
    G =
  \begin{cases}
    1 &amp; \text{if $G$ = 2} \\
    0 &amp; \text{otherwise}
  \end{cases}
\]</div>
<p>For heterozygous model</p>
<div class="arithmatex">\[
    G =
  \begin{cases}
    1 &amp; \text{if $G$ = 1} \\
    0 &amp; \text{otherwise}
  \end{cases}
\]</div>
<p>Then depending on the <code>--score</code> option, the PRS is calculated as (assuming <span class="arithmatex">\(M_j\)</span> is the number of Alleles included in the PRS of the <span class="arithmatex">\(j^{th}\)</span> individual)</p>
<p><code>--score avg</code> (default):
$$
    PRS_j = \sum_i{\frac{S_i\times G_{ij}}{M_j}}
$$</p>
<p><code>--score sum</code>:
$$
    PRS_j = \sum_i{S_i\times G_{ij}}
$$</p>
<p><code>--score std</code>:
$$
    PRS_j = \frac{\sum_i({S_i\times G_{ij}}) - \text{Mean}(PRS)}{\text{SD}(PRS)}
$$</p>
<p><code>--score con-std</code>:
$$
    PRS_j = \frac{\sum_i({S_i\times G_{ij}}) - \text{Mean}(PRS in control)}{\text{SD}(PRS in control)}
$$</p>
<p>Specifically, the quantile plot is generated by the following steps</p>
<ol>
<li>Distribute samples into user specified number of quantiles based on their PRS</li>
<li>Treat the quantiles as a factor, where the <code>--quant-ref</code> is the base factor</li>
<li>Perform regression with <span class="arithmatex">\(Pheno \sim Quantile + Covariates\)</span> (use logistic regression if phenotype is binary, and linear regression otherwise)</li>
<li>Set the reference quantile to have coefficient of 1 (if binary) or 0 (otherwise)</li>
</ol>
<p>The point of each quantile is their OR (if binary) or coefficient (otherwise) from the regression analysis</p>
<p>A text file [Name]_QUANTILE\_[date].txt is also produced, which provides all the data used for the plotting. </p>
<p>Moreover, uneven distribution of quantiles can be specified using the <code>--quant-break</code> function, 
which will generate the strata plot. 
For example, to replicate the quantile break from Natarajan et al (2015):</p>
<table>
<thead>
<tr>
<th align="center">Percentile of PRS, %</th>
<th align="center">All studies in iCOGS excluding pKARMA <br> OR (95% CI)</th>
<th align="center">pKARMA only <br> OR (95% CI)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">&lt;1</td>
<td align="center">0.29 (0.23 to 0.37)</td>
<td align="center">0.48 (0.28 to 0.83)</td>
</tr>
<tr>
<td align="center">&gt;1–5</td>
<td align="center">0.42 (0.37 to 0.47)</td>
<td align="center">0.48 (0.36 to 0.63)</td>
</tr>
<tr>
<td align="center">5–10</td>
<td align="center">0.55 (0.50 to 0.61)</td>
<td align="center">0.58 (0.45 to 0.74)</td>
</tr>
<tr>
<td align="center">10–20</td>
<td align="center">0.65 (0.60 to 0.70)</td>
<td align="center">0.68 (0.57 to 0.81)</td>
</tr>
<tr>
<td align="center">20–40</td>
<td align="center">0.80 (0.76 to 0.85)</td>
<td align="center">0.81 (0.71 to 0.94)</td>
</tr>
<tr>
<td align="center">40–60</td>
<td align="center">1 (referent)</td>
<td align="center">1 (referent)</td>
</tr>
<tr>
<td align="center">60–80</td>
<td align="center">1.18 (1.12 to 1.24)</td>
<td align="center">1.35 (1.19 to 1.54)</td>
</tr>
<tr>
<td align="center">80–90</td>
<td align="center">1.48 (1.39 to 1.57)</td>
<td align="center">1.56 (1.34 to 1.82)</td>
</tr>
<tr>
<td align="center">90–95</td>
<td align="center">1.69 (1.56 to 1.82)</td>
<td align="center">2.05 (1.70 to 2.47)</td>
</tr>
<tr>
<td align="center">95–99</td>
<td align="center">2.20 (2.03 to 2.38)</td>
<td align="center">2.12 (1.73 to 2.59)</td>
</tr>
<tr>
<td align="center">&gt;99</td>
<td align="center">2.81 (2.43 to 3.24)</td>
<td align="center">3.06 (2.16 to 4.34)</td>
</tr>
</tbody>
</table>
<p>The following command can be added to PRSice command:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>--quantile 100 \
--quant-break 1,5,10,20,40,60,80,90,95,99,100 \
--quant-ref 60
</pre></div>
<p>Specifically, <code>--quant-break</code> indicates the <strong>upper bound</strong> of each group and <code>--quant-ref</code> specify the <strong>upper bound</strong> of the reference quantiles</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The quantile boundaries are non-overlapping, with the inclusive upper bound and exclusive lower bound </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Usually, you will need <code>--quantile 100</code> together with <code>--quant-break</code></p>
</div>
<p>A file containing the PRS model fit across thresholds is named <em>[Name].prsice</em>; this is stored as</p>
<blockquote>
<p>Set, Threshold, <span class="arithmatex">\(R^2\)</span>, P-value, Coefficient, Standard Deviation and Number of SNPs at this threshold</p>
</blockquote>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><span class="arithmatex">\(R^2\)</span> reported in the prsice file is the <span class="arithmatex">\(R^2\)</span> of the Full model - the <span class="arithmatex">\(R^2\)</span> of the Null model</p>
</div>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../javascripts/details.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
